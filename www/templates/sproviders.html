<ion-list class="list card">
  <ion-item class="item" ng-repeat="sprovider in sproviders | orderBy: 'name' ">
    <div class="item item-divider"><h3>{{sprovider.name}}</h3></div>
    <p>
      <img class="full-image" ng-src="assets\img\categories\placeholder.jpg">
    </p>
    <ion-item class="card item-text-wrap">
      <div class="item item-icon-left"><i class="icon ion-bowtie dark"></i> {{sprovider.services}}</div>
      <div class="item item-icon-left"><a href="{{sprovider.website}}"><i class="icon ion-earth balanced"></i>{{sprovider.website}}</a></div>
      <div class="item item-icon-left"><i class="icon ion-location assertive"></i> {{sprovider.street}}, {{sprovider.city}}</div>
      <div  ng-repeat="contact in sprovider.contactPersons">
      <div class="item item-icon-left"><i class="icon ion-person royal"></i> {{contact.firstName}} {{contact.lastName}} ({{contact.type}})</div>
      <div class="item item-icon-left"><i class="icon ion-email calm"></i>  {{contact.email}}</div>
      <div><a class="item item-icon-left" ng-href="tel: {{contact.phone}}"> <i class="icon ion-ios-telephone-outline"></i>Click-to-Call {{contact.phone}}</a></div>

    </div>
  </ion-item>
    <!--ion-item ui-sref="app.team({sproviderId: sprovider.id})" >sprovider Contacts</ion-item-->
    <div class="item item-body">
      <p>
        <a href="#" class="subdued">{{sprovider.likes.length}} Likes</a>
          <a ng-click="toggleReviews()" class="subdued">{{sprovider.reviews.length}} Reviews (Click-to <i class = "icon ion-arrow-expand"></i>)</a>
      </p>
    </div>
    <!--ion-nav-view-->

    <!--/ion-nav-view-->
    <!--Options Bar: Like, Comment and Rate-->
    <div class="item tabs tabs-secondary tabs-icon-left" ng-show="isAuthenticated()">
    <a href="#" ng-model="like" ng-disabled="!can(appActions.like)" ng-click="likeClick(sprovider)" class="tab-item" >
      <i class="icon ion-thumbsup"></i>
      {{sprovider.liked}}
    </a>
    <a class="tab-item" ng-click="review_rating=isAuthenticated()" ng-disabled="!can(appActions.review)">
    <!--a class="tab-item" ng-click="showPopup(sprovider)" ng-disabled="!can(appActions.review)"-->
      <i class="icon ion-star"></i>
      Rate
    </a>
  </div>
  <div class="item tabs tabs-secondary tabs-icon-left" ng-hide="isAuthenticated()">
    <a ui-sref="app.login" style="margin:0px 2px 0 2px;">Login</a> or <a ui-sref="app.signup" style="margin:0px 2px 0 2px;">Sign up</a> to like and review
  </div>
  <!--Section below adds profile pic and comment section-->
  <div ng-show="review_rating">
    <form  name="reviewForm" ng-submit="submitReview(sprovider)">
      <ion-list>
          <ion-item>
            <p>{{review.rating}} Stars</p>
            <p>{{review.comment}}</p>
            <p> - {{user().username}}</p>
          </ion-item>
      </ion-list>
      <div class="review_input">
        <div style="background-color: white" class="item-input-wrapper">
          <img class="review-profile-pic" ng-src="{{sessionUser.user.profilePic.url()}}">
          <rating ng-model="review.rating" max="review.max"></rating>
        </div>
        <label class="item item-input" >
          <textarea ng-model="review.comment" placeholder="Enter comment"></textarea>
        </label>

      </div>
        <button class="button button-stable button-block" ng-disabled="reviewForm.$invalid">
          Rate Service
        </button>
  </form>
</div>
  <!--This section displays all the views for that sprovider-->
  <div ng-show="reviews_display">
      <ion-item class="subdued">{{sprovider.likes.length}} people like this</ion-item>
        <ion-list>
          <ion-item class="item item-body" ng-repeat="review in sprovider.reviews">
            <p>{{review.rating}} Stars</p>
            <p>{{review.comment}}</p>
            <p> - {{review.author}}</p>
          </ion-item>
      </ion-list>
  </div>


</ion-list>
